# Default termtype. If the rcfile sets $TERM, that overrides this value.
set -g default-terminal screen-256color

# For combatibility with terminals using old versions of libvte
set -ag terminal-overrides ',xterm*:Cr=\E]12;gray\007'

run-shell "tmux set-environment -g TMUX_VERSION $(tmux -V | cut -d' ' -f2 | sed 's/[a-zA-Z]//g')"

# Make mouse useful in copy mode
if-shell '[ $(echo "$TMUX_VERSION >= 2.1" | bc) -eq 1 ]' \
    "set -as terminal-overrides ',*:indn@'; \
     set -g mouse on"
if-shell '[ $(echo "$TMUX_VERSION < 2.1" | bc) -eq 1 ]' \
    "set -ag terminal-overrides ',*:indn@'; \
     setw -g mode-mouse on; \
     set -g mode-mouse on; \
     set -g mouse-select-window on; \
     set -g mouse-select-pane on; \
     set -g mouse-resize-pane on"

# Use vim keybindings in copy mode
setw -g mode-keys vi

# Ring the bell if any background window rang a bell
set -g bell-action any

# Load tmux-status generated by vimline
if-shell "test -f ~/.tmux/tmux-status.conf" "source ~/.tmux/tmux-status.conf"

# Use the 'default' prefix as an alt tab (aka C-b+C-b = alt+tab)
bind C-b last-window

# Since by default C-b sends the prefix we just remapped it to b
bind b send-prefix

# split using | and - instead of % and "
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Vim navigation for panels
bind -r h select-pane -L
bind -r j select-pane -D
bind -r k select-pane -U
bind -r l select-pane -R

# Resize using modified vim navigation
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# auto renumber windows when lower values are closed
set -g renumber-windows on

# to make ctrl-arrow, etc. work
set -gw xterm-keys on

# auto set pane titles
set -g set-titles on

# auto set pane titles
set -g focus-events on

# TMUX prefix highlight settings
set -g @prefix_highlight_prefix_prompt 'Prefix'
set -g @prefix_highlight_fg 'black'
set -g @prefix_highlight_show_copy_mode 'on'
set -g @prefix_highlight_copy_prompt 'Copy'

# TMUX plugins
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
set -g @plugin 'tmux-plugins/tmux-copycat'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Initialize TMUX Plugin Manager (must be last line)
run '~/.tmux/plugins/tpm/tpm'
